---
description: 
globs: 
alwaysApply: false
---
# STM32开发规则

## LED控制基础
1. **引脚识别**：
   - 板载LED通常连接在PC13（低电平点亮）
   - 外部LED连接需确认具体引脚和极性（PA0等）

2. **GPIO配置**：
   - 使用前必须启用对应端口时钟（`__HAL_RCC_GPIOx_CLK_ENABLE()`）
   - 配置正确的输出模式、速度和上下拉状态

## 调试连接维护
1. **SWD接口保护**：
   - 避免重新配置PA13/PA14（SWDIO/SWCLK）引脚
   - 使用`__HAL_AFIO_REMAP_SWJ_NOJTAG()`保留SWD但禁用JTAG

2. **主循环设计**：
   - 使用`HAL_Delay()`替代空循环保持调试连接
   - 避免连续的忙等待导致调试器无法连接

## 代码组织
1. **HAL库使用**：
   - 确保包含正确的头文件（`main.h`）
   - 避免多重定义冲突（如`SysTick_Handler`）

2. **时钟配置**：
   - 遵循初始化顺序：HAL库 → 系统时钟 → 外设时钟
   - 正确配置时钟源和分频

## 错误处理
1. **编译错误解决**：
   - 识别并使用与芯片型号兼容的API函数
   - 注意不同STM32系列间API差异

2. **运行时问题**：
   - 使用LED状态指示程序运行状态
   - 实现合理的错误处理函数
